# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: SceneManagerService

## üîß –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. **–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (0.0 - 1.0)**

**–ë—ã–ª–æ:**
```csharp
while (!operation.isDone)
{
    _sceneLoadProgressSubject.OnNext(operation.progress); // 0.0 - 0.9 ‚ùå
    await UniTask.Yield();
}
```

**–°—Ç–∞–ª–æ:**
```csharp
while (!operation.isDone)
{
    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º 0.9 ‚Üí 1.0
    float progress = Mathf.Clamp01(operation.progress / 0.9f);
    _sceneLoadProgressSubject.OnNext(progress); // 0.0 - 1.0 ‚úÖ
    await UniTask.Yield();
}
```

**–ü–æ—á–µ–º—É:** Unity's `AsyncOperation.progress` –∏–¥—ë—Ç —Ç–æ–ª—å–∫–æ –¥–æ 0.9, –∑–∞—Ç–µ–º –ø—Ä—ã–≥–∞–µ—Ç –Ω–∞ `isDone`. –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0-100%.

---

### 2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ü–µ–Ω—ã**

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```csharp
// Release assets from previous scene if loading in Single mode
if (mode == LoadSceneMode.Single)
{
    _addressableService.ReleaseAllAssets();
}
```

**–ü–æ—á–µ–º—É:** –ö–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å—Ü–µ–Ω–∞ –≤ Single mode, —Å—Ç–∞—Ä–∞—è —Å—Ü–µ–Ω–∞ –≤—ã–≥—Ä—É–∂–∞–µ—Ç—Å—è, –Ω–æ –µ—ë Addressable –∞—Å—Å–µ—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏. –¢–µ–ø–µ—Ä—å –æ–Ω–∏ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

### 3. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –≤—ã–≥—Ä—É–∑–∫–µ**

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ UnloadSceneAsync:**
```csharp
// Release addressable assets
_addressableService.ReleaseAllAssets();

// Force garbage collection
await Resources.UnloadUnusedAssets();
```

**–ü–æ—á–µ–º—É:** –ü–æ—Å–ª–µ –≤—ã–≥—Ä—É–∑–∫–∏ —Å—Ü–µ–Ω—ã –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –∏–∑ –ø–∞–º—è—Ç–∏.

---

### 4. **Dispose –¥–ª—è Subject (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏)**

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```csharp
public class SceneManagerService : ISceneManagerService, IDisposable
{
    public void Dispose()
    {
        _sceneLoadProgressSubject?.Dispose();
        _sceneLoadedSubject?.Dispose();
    }
}
```

**–ü–æ—á–µ–º—É:** R3 Subject'—ã –Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å, –∏–Ω–∞—á–µ memory leak.

---

### 5. **–õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```csharp
Debug.Log($"[SceneManagerService] Scene {sceneId} ({loadedSceneName}) loaded successfully");
```

**–ü–æ—á–µ–º—É:** –¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ –∏ enum, –∏ —Ä–µ–∞–ª—å–Ω–æ–µ –∏–º—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π —Å—Ü–µ–Ω—ã.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –î–û –∏ –ü–û–°–õ–ï:

### –î–û:
```
–ó–∞–≥—Ä—É–∑–∫–∞:
0% ‚Üí 10% ‚Üí 20% ‚Üí ... ‚Üí 90% ‚Üí 100% (–ø—Ä—ã–∂–æ–∫)
                              ‚Üë
                         –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥—ë—Ä–≥–∞–µ—Ç—Å—è!

Memory:
[–ó–∞–≥—Ä—É–∑–∫–∞ MainMenu]
[–ó–∞–≥—Ä—É–∑–∫–∞ Loading] ‚Üê –ê—Å—Å–µ—Ç—ã MainMenu –µ—â—ë –≤ –ø–∞–º—è—Ç–∏ ‚ùå
[–ó–∞–≥—Ä—É–∑–∫–∞ GameplayDemo] ‚Üê –ê—Å—Å–µ—Ç—ã Loading –µ—â—ë –≤ –ø–∞–º—è—Ç–∏ ‚ùå
```

### –ü–û–°–õ–ï:
```
–ó–∞–≥—Ä—É–∑–∫–∞:
0% ‚Üí 10% ‚Üí 20% ‚Üí ... ‚Üí 90% ‚Üí 95% ‚Üí 100% (–ø–ª–∞–≤–Ω–æ)
                                    ‚Üë
                         –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ!

Memory:
[–ó–∞–≥—Ä—É–∑–∫–∞ MainMenu]
[–í—ã–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤ MainMenu] ‚úÖ
[–ó–∞–≥—Ä—É–∑–∫–∞ Loading]
[–í—ã–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤ Loading] ‚úÖ
[–ó–∞–≥—Ä—É–∑–∫–∞ GameplayDemo]
```

---

## ‚úÖ –¢–µ–ø–µ—Ä—å SceneManagerService:

- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å 0-100%
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≥—Ä—É–∂–∞–µ—Ç –∞—Å—Å–µ—Ç—ã –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ü–µ–Ω—ã
- ‚úÖ –û—á–∏—â–∞–µ—Ç –ø–∞–º—è—Ç—å –ø–æ—Å–ª–µ –≤—ã–≥—Ä—É–∑–∫–∏
- ‚úÖ –ù–µ—Ç —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏ (Dispose)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SceneId enum
- ‚úÖ –õ—É—á—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üéÆ –ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç:

### LoadingProgressView —Ç–µ–ø–µ—Ä—å:
- –ü–ª–∞–≤–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –±–µ–∑ —Ä—ã–≤–∫–æ–≤
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–æ—Ö–æ–¥–∏—Ç –¥–æ 100% –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### –ü–∞–º—è—Ç—å:
- –°—Ç–∞—Ä—ã–µ –∞—Å—Å–µ—Ç—ã –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ú–µ–Ω—å—à–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –ø–∞–º—è—Ç–∏
- –ù–µ—Ç —É—Ç–µ—á–µ–∫

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞ (–Ω–µ –¥–µ—Ä–∂–∏–º –ª–∏—à–Ω–µ–µ –≤ –ø–∞–º—è—Ç–∏)
- –õ—É—á—à–µ –Ω–∞ WebGL (–º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ = –≤–∞–∂–Ω–æ!)

---

**–í–°–Å –ò–°–ü–†–ê–í–õ–ï–ù–û!** üéâ
